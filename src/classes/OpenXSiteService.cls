//
// Generated by JSON2Apex http://json2apex.herokuapp.com/
// Request format : curl http://openx_server_name/ox/4.0/site/available_fields?pretty=1 
// document : http://docs.openx.com/api/#api_create_site_use_case.html

Global with sharing class OpenXSiteService {

    public String account_uid;
    public String name;
    public String status;
    public String url;
    public String content_type_id;
    public String delivery_medium_id;

     public OpenXSiteService (JSONParser parser)
    {
        while (parser.nextToken() != JSONToken.END_OBJECT) 
        {
            if (parser.getCurrentToken() == JSONToken.FIELD_NAME) 
                {
                    String text = parser.getText();
                                        
                    if (parser.nextToken() != JSONToken.VALUE_NULL) 
                    {
                        if (text == 'account_uid')
                        {
                            account_uid=parser.getText();
                        }else if(text =='name')
                        {
                             name=parser.getText();
                        }else if(text =='status')
                        {
                             status=parser.getText();
                        }
                        else if(text =='url')
                        {
                            url=parser.getText();
                        }
                        else if(text =='content_type_id')
                        {
                             content_type_id=parser.getText();
                        }
                        else if(text =='delivery_medium_id')
                        {
                             delivery_medium_id=parser.getText();
                        }
                        
                     }
                 }
             else
             {
                 //TODO : incase a value null
             }
       }
  }   
  //Get Site Data List from OpenX
      webService static OpenXSiteService GetSiteList(String accessApikey) {  
                String Apiendpoint= 'http://openx_server_name/ox/4.0/site?pretty=1'; 
                Http h = new Http();
                HttpRequest req = new HttpRequest();
                req.setMethod('GET');
                req.setHeader('openx3_access_token',accessApikey);
                req.setHeader('Content-Type', 'application/x-www-form-urlencoded');                       
                req.setEndpoint(Apiendpoint);                         
                HttpResponse res=new HttpResponse();
                res = h.send(req);              
                return new OpenXSiteService(System.JSON.createParser(res.getbody()));
     }
     
      //Create Site on OpenX
       webService static OpenXSiteService CreateSite(String accessApikey,OpenXSiteService site) {
                String Apiendpoint= 'http://openx_server_name/ox/4.0/site?pretty=1';
                string jsonContent= Json.Serialize(site);                
                Http h = new Http();
                HttpRequest req = new HttpRequest();
                req.setMethod('POST');
                req.setHeader('openx3_access_token',accessApikey);
                req.setHeader('Content-Type', 'application/x-www-form-urlencoded');
                req.setBody('advertiser='+jsonContent);
                req.setEndpoint(Apiendpoint);                        
                HttpResponse res=new HttpResponse();
                res = h.send(req);
                return new OpenXSiteService(System.JSON.createParser(res.getbody()));
      }
     //Update Site on OpenX
      webService static OpenXSiteService UpdateSite(String accessApikey,Integer id,OpenXSiteService site) {
                String Apiendpoint= 'http://openx_server_name/ox/4.0/site'+id+'?pretty=1';
                string jsonContent= Json.Serialize(site); 
                Http h = new Http();
                HttpRequest req = new HttpRequest();
                req.setMethod('PUT');
                req.setHeader('openx3_access_token',accessApikey);
                req.setHeader('Content-Type', 'application/x-www-form-urlencoded');
                req.setBody('advertiser='+jsonContent);               
                req.setEndpoint(Apiendpoint);                        
                HttpResponse res=new HttpResponse();
                res = h.send(req);
                return new OpenXSiteService(System.JSON.createParser(res.getbody()));
     } 
    
   
}